<!DOCTYPE html>
<html><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Machine Learning c&#417; b&#7843;n</title><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"><script src="js/3.1.1-jquery.min.js"></script><script src="js/js-bootstrap.min.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300" rel="stylesheet"><!-- <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> --><link href="https://fonts.googleapis.com/css?family=Roboto%7CSource+Sans+Pro" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Ubuntu" rel="stylesheet"><link href="https://fonts.googleapis.com/css?family=Fira+Sans" rel="stylesheet"><!-- Include CSS SCSS --><link rel="stylesheet" type="text/css" href="css/style-post.css"><link rel="stylesheet" type="text/css" href="css/css-monokai.css"><link rel="stylesheet" type="text/css" href="css/css-mystyle.css"><!-- <link rel="stylesheet" type="text/css" href="/css/github.css" /> --><title>B&agrave;i 6: K-nearest neighbors</title><!-- <script>
var pageProperties = {
    
    category: "Instance-based",
    
    url: "/2017/01/08/knn/",
    title: "B&agrave;i 6: K-nearest neighbors",
    scripts: [
        
    ],
};

</script>
<script src="/scripts/modules.js" async></script>
 --><link rel="icon" type="image/png" href="favicons/latex-new_logo9.png" sizes="32x32"><link rel="canonical" href="https://machinelearningcoban.com/2017/01/08/knn/"><meta name="author" content="Tiep Vu "><meta property="og:title" content="B&agrave;i 6: K-nearest neighbors"><meta property="og:site_name" content="Tiep Vu's blog"><meta property="og:url" content="https://machinelearningcoban.com/2017/01/08/knn/"><meta property="og:description" content=""><meta property="og:type" content="article"><meta property="article:published_time" content="2017-01-08"><meta property="article:author" content="Tiep Vu"><meta property="article:section" content="Instance-based"><meta property="article:tag" content="KNN"><meta property="article:tag" content="Regression"><meta property="article:tag" content="Classification"><meta property="article:tag" content="Supervised-learning"><meta property="article:tag" content="MNIST"><meta property="article:tag" content="Iris"><link rel="alternate" type="application/atom+xml" title="Tiep Vu's blog - Atom feed" href="/feed.xml"><!-- Google Analytics --><script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-89509207-1', 'auto');
// ga('send', 'pageview');
ga('send', 'pageview', {
'page': '/2017/01/08/knn/',
'title': 'B&agrave;i 6: K-nearest neighbors'
});
</script><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-KTCD8BX');</script><!-- End Google Tag Manager --></head><body>
	<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.9";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script><br><div class="container">
      	<div class="row">
	        <div class="col-md-2 hidden-xs hidden-sm">
	          	<a href="machinelearningcoban.html">
            <!-- <img width="80%" src="/images/logo.svg" /> -->
            <!-- <img width="100%" src="/images/logoTet.png" /> -->
            <!-- <img width="100%" src="/images/logo2.png" /> -->
            <!-- <img width="100%" style="padding-bottom: 3mm;" src="/images/logo_new.png" /> </a> -->
            <img width="100%" style="padding-bottom: 3mm;" src="images/latex-new_logo92.png"></a>
          <!-- <img width="100%" style="padding-bottom: 3mm;" src="/assets/latex/new_logo2_rau.png" /> </a> -->

            <br><a href="buymeacoffee.html">
            <img width="100%" style="padding-bottom: 3mm;" src="images/images-Buymeacoffee_blue.png"><br></a><a href="ebook.html">
            <img width="100%" style="padding-bottom: 3mm;" src="images/images-ebook_logo.png"><!-- <script type='text/javascript' src='https://ko-fi.com/widgets/widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Buy Me a Coffee', '#074B80', 
            'A40822MV');kofiwidget2.draw();</script>  --><!-- 
            <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
            <input type="hidden" name="cmd" value="_donations">
            <input type="hidden" name="business" value="vuhuutiep@gmail.com">
            <input type="hidden" name="lc" value="US">
            <input type="hidden" name="item_name" value="I find machinelearningcoban.com helpful. I'd like to buy Tiep Vu a coffee ^^. (Thank you so much for your support.)">
            <input type="hidden" name="no_note" value="0">
            <input type="hidden" name="currency_code" value="USD">
            <input type="hidden" name="bn" value="PP-DonationsBF:Buymeacoffee.png:NonHostedGuest">
            <input type="image" src="/images/Buymeacoffee_blue.png" border="0" style="padding-bottom: -9mm;" width = 100% name="submit" alt="PayPal - The safer, easier way to pay online!">
            </form> --><!-- <script type='text/javascript' src='https://ko-fi.com/widgets/widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Buy Me a Coffee', '#805007', 'A40822MV');kofiwidget2.draw();</script>  --></a>

          <!-- Google search -->
         <!--  <table border="0">
          <div id = "top-widget" style="width: 292px; margin-left: -13.5px; margin-top: -10px; margin-bottom: -15px;">
         <script>
           (function() {
             var cx = '012053542614118746585:ktgei4l2oek';
             var gcse = document.createElement('script');
             gcse.type = 'text/javascript';
             gcse.async = true;
             gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
             var s = document.getElementsByTagName('script')[0];
             s.parentNode.insertBefore(gcse, s);
           })();
         </script>
         <gcse:search></gcse:search>
          </div>
          </table> -->

          <!-- <nav>
          
            <div class="header">Popular</div>
            <ul>
              <li> (**): > 10k views</li>
              <li> (*) : > 5k views</li>
            </ul>
          </nav> -->
          

          
          <nav><div class="header">Latest by category</div>
            <ul><li><a style="text-align: left; color: #074B80;" href="knn.html">6. K-nearest neighbors</a></li>
                  
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul></nav><nav><div class="header">Latest</div>
              
                <li><a style="text-align: left; color: #074B80" href="lifesofar2.html">Con &#273;&#432;&#7901;ng h&#7885;c PhD c&#7911;a t&ocirc;i</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="conv2d.html">37. T&iacute;ch ch&#7853;p hai chi&#7873;u</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="forum.html">Di&#7877;n &#273;&agrave;n</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="deeplearning.html">36. Keras</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="deeplearning.html">35. L&#432;&#7907;c s&#7917; Deep Learning</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="phuonghoagiang.html">Con &#273;&#432;&#7901;ng h&#7885;c Khoa h&#7885;c d&#7919; li&#7879;u c&#7911;a m&#7897;t sinh vi&ecirc;n Kinh t&#7871;</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="id3.html">34. Decision Trees (1): ID3</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="evaluation.html">33. &#272;&aacute;nh gi&aacute; h&#7879; th&#7889;ng ph&acirc;n l&#7899;p</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="fundaml_vectors.html">FundaML 3: C&aacute;c m&#7843;ng ng&#7851;u nhi&ecirc;n</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="fundaml_matrices.html">FundaML 2: Ma tr&#7853;n</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="fundaml_vectors.html">FundaML 1: M&#7843;ng m&#7897;t chi&#7873;u</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="fundaml.html">FundaML.com</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="nbc.html">32. Naive Bayes Classifier</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="phdlife.html">Vi&#7871;t v&agrave; nh&#7853;n x&eacute;t c&aacute;c b&agrave;i b&aacute;o khoa h&#7885;c</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="mlemap.html">31. Maximum Likelihood v&agrave; Maximum A Posteriori</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="lifesofar.html">Con &#273;&#432;&#7901;ng h&#7885;c To&aacute;n c&#7911;a t&ocirc;i</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="prob.html">30. &Ocirc;n t&#7853;p X&aacute;c Su&#7845;t</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="tl.html">Q2. Transfer Learning</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="lda.html">29. Linear Discriminant Analysis</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="qns1.html">Q1. Quick Notes 1</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="pca2.html">28. Principal Component Analysis (2/2)</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="pca.html">27. Principal Component Analysis (1/2)</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="svd.html">26. Singular Value Decomposition</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="matrixfactorization.html">25. Matrix Factorization Collaborative Filtering</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="collaborativefiltering.html">24. Neighborhood-Based Collaborative Filtering</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="contentbasedrecommendersys.html">23. Content-based Recommendation Systems</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="multiclasssmv.html">22. Multi-class SVM</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="kernelsmv.html">21. Kernel SVM</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="softmarginsmv.html">20. Soft Margin SVM</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="smv.html">19. Support Vector Machine</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="duality.html">18. Duality</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="convexopt.html">17. Convex Optimization Problems</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="convexity.html">16. Convex sets v&agrave; convex functions</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="overfitting.html">15. Overfitting</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="mlp.html">14. Multi-layer Perceptron v&agrave; Backpropagation</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="softmax.html">13. Softmax Regression</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="binaryclassifiers.html">12. Binary Classifiers</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="featureengineering.html">11. Feature Engineering</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="howdoIcreatethisblog.html"></a></li>
              
                <li><a style="text-align: left; color: #074B80" href="logisticregression.html">10. Logistic Regression</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="perceptron.html">9. Perceptron Learning Algorithm</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="gradientdescent2.html">8. Gradient Descent (2/2)</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="gradientdescent.html">7. Gradient Descent (1/2)</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="knn.html">6. K-nearest neighbors</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="kmeans2.html">5. K-means Clustering - Applications</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="kmeans.html">4. K-means Clustering</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="linearregression.html">3. Linear Regression</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="categories.html">2. Ph&acirc;n nh&oacute;m c&aacute;c thu&#7853;t to&aacute;n Machine Learning</a></li>
              
                <li><a style="text-align: left; color: #074B80" href="introduce.html">1. Gi&#7899;i thi&#7879;u v&#7873; Machine Learning</a></li>
              
            
          </nav><!-- <img style = "transform: scaleX(1); width:100%; margin-left:00px;position: absolute;" src = "/images/mai.jpg"> --><!--   
            <nav>
              <div class="header">Previous by date</div>
              <ul>
                <li><a style="text-align: left; font-family: 'Roboto Condensed', sans-serif; color: #074B80;" href="/2017/01/04/kmeans2/">B&agrave;i 5: K-means Clustering: Simple Applications</a></li>
              </ul>
            </nav>
           
           
            <nav>
              <div class="header">Next by date</div>
              <ul>
                <li><a style="text-align: left; font-family: 'Roboto Condensed', sans-serif; color: #074B80;" href="/2017/01/12/gradientdescent/">B&agrave;i 7: Gradient Descent (ph&#7847;n 1/2)</a></li>
              </ul>
            </nav>
            --></div>
	        <div class="col-md-8 col-xs-12" style="z-index: 1">
	        	 <!-- <br> -->
 <nav class="navbar navbar-inverse" style="background-color: #074B80"><div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span> 
      </button>
      <a class="navbar-brand" href="machinelearningcoban.html"><span style="color: #fff">Machine Learning c&#417; b&#7843;n</span></a>
        <!-- <form class="navbar-form navbar-left" role="search">
            <div class="form-group" align="right">
                <input type="text" class="form-control" placeholder="Search">
            </div>
            <button type="submit" class="btn btn-default">
                <span></span>
            </button>
        </form> -->
        


    </div>
    <div class="collapse navbar-collapse navbar-right" id="myNavbar">
      <ul class="nav navbar-nav"><li><a href="about.html"><span style="color: #fff"> About</span></a></li>
        <li><a href="index.html"><span style="color: #fff">Index</span></a></li>
        <li><a href="tags.html"><span style="color: #fff">Tags</span></a></li>
        <li><a href="categories.html"><span style="color: #fff">Categories</span></a></li>
        <li><a href="archive.html"><span style="color: #fff">Archive</span></a></li>
        <li><a href="math.html"><span style="color: #fff">Math</span></a></li>
        <!-- <li><a href="https://docs.google.com/forms/d/e/1FAIpQLScq3GkxM1I2fDevR7gth-O9QqxM7grf4AFc0WT1hFORv4flaw/viewform"><span style = "color: #fff">Survey</span></a></li> -->
        <li><a href="copyrights.html"><span style="color: #fff">Copyrights</span></a></li>
        <!-- <li><a href="/faqs/"><span style = "color: #fff">FAQs</span></a></li> -->
        <li><a href="ebook.html"><span style="color: #fff">ebook</span></a></li>
        <li><a href="search.html"><span style="color: #fff">Search</span></a></li>
        <!-- <li><a href="https://github.com/tiepvupsu/tiepvupsu.github.io/blob/master/assets/latex/book.pdf"><span style = "color: #fff">Book</span></a></li> -->
        <!-- <li><a href="https://www.facebook.com/groups/257768141347267/"><span style = "color: #fff">Forum</span></a></li> -->
        <!-- <li><a href="/subscribe/">Subscribe</a></li> -->

        <li> 
      </li></ul></div>
  </div>
</nav><!-- <div class = "row"> --><!-- <div class = "col-xs-12 hidden-md hidden-lg"> --><!-- previous and next posts --><div class="PageNavigation">
         
            <a class="prev" style="color: #074B80;" href="kmeans2.html">&laquo; B&agrave;i 5: K-means Clustering: Simple Applications</a>
         <!-- <hr> -->
         
         
            <a class="next" style="float: right; color: #074B80;" href="gradientdescent.html">B&agrave;i 7: Gradient Descent (ph&#7847;n 1/2) &raquo;</a>
         <hr></div>
  <!-- </div> -->
<!-- </div> -->
<h1 itemprop="name" class="post-title">B&agrave;i 6: K-nearest neighbors</h1>


<ul class="tags"><a href="/tags#KNN" class="tag">KNN</a>
   
      <a href="/tags#Regression" class="tag">Regression</a>
   
      <a href="/tags#Classification" class="tag">Classification</a>
   
      <a href="/tags#Supervised-learning" class="tag">Supervised-learning</a>
   
      <a href="/tags#MNIST" class="tag">MNIST</a>
   
      <a href="/tags#Iris" class="tag">Iris</a>
   
</ul><span class="post-date" style="color: gray; font-style: italic;">Jan 8, 2017
            </span>
<!-- Main content -->
<br><br><div itemprop="articleBody">
   <!-- <div class="imgcap">
<div >
<a href = "/2017/01/08/knn/">
    <img src ="https://upload.wikimedia.org/wikipedia/commons/5/52/Map1NN.png" align = "center" width="800"></a>
</div>
<div class="thecap"> B&#7843;n &#273;&#7891; c&#7911;a 1NN (Ngu&#7891;n: <a href = "https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">Wikipedia</a>) <br></div>
</div> -->

<p>N&#7871;u nh&#432; con ng&#432;&#7901;i c&oacute; ki&#7875;u h&#7885;c &ldquo;n&#432;&#7899;c &#273;&#7871;n ch&acirc;n m&#7899;i nh&#7843;y&rdquo;, th&igrave; trong Machine Learning c&#361;ng c&oacute; m&#7897;t thu&#7853;t to&aacute;n nh&#432; v&#7853;y.</p>

<p><strong>Trong trang n&agrave;y:</strong>
<!-- MarkdownTOC --></p>

<ul><li><a href="#-gioi-thieu">1. Gi&#7899;i thi&#7879;u</a>
    <ul><li><a href="#mot-cau-chuyen-vui">M&#7897;t c&acirc;u chuy&#7879;n vui</a></li>
      <li><a href="#k-nearest-neighbor">K-nearest neighbor</a></li>
      <li><a href="#khoang-cach-trong-khong-gian-vector">Kho&#7843;ng c&aacute;ch trong kh&ocirc;ng gian vector</a></li>
    </ul></li>
  <li><a href="#-phan-tich-toan-hoc">2. Ph&acirc;n t&iacute;ch to&aacute;n h&#7885;c</a></li>
  <li><a href="#-vi-du-tren-python">3. V&iacute; d&#7909; tr&ecirc;n Python</a>
    <ul><li><a href="#bo-co-so-du-lieu-iris-iris-flower-dataset">B&#7897; c&#417; s&#7903; d&#7919; li&#7879;u Iris (Iris flower dataset).</a></li>
      <li><a href="#thi-nghiem">Th&iacute; nghi&#7879;m</a>
        <ul><li><a href="#tach-training-va-test-sets">T&aacute;ch training v&agrave; test sets</a></li>
          <li><a href="#phuong-phap-danh-gia-evaluation-method">Ph&#432;&#417;ng ph&aacute;p &#273;&aacute;nh gi&aacute; (evaluation method)</a></li>
          <li><a href="#danh-trong-so-cho-cac-diem-lan-can">&#272;&aacute;nh tr&#7885;ng s&#7889; cho c&aacute;c &#273;i&#7875;m l&acirc;n c&#7853;n</a></li>
        </ul></li>
    </ul></li>
  <li><a href="#-thao-luan">4. Th&#7843;o lu&#7853;n</a>
    <ul><li><a href="#knn-cho-regression">KNN cho Regression</a></li>
      <li><a href="#chuan-hoa-du-lieu">Chu&#7849;n h&oacute;a d&#7919; li&#7879;u</a></li>
      <li><a href="#su-dung-cac-phep-do-khoang-cach-khac-nhau">S&#7917; d&#7909;ng c&aacute;c ph&eacute;p &#273;o kho&#7843;ng c&aacute;ch kh&aacute;c nhau</a></li>
      <li><a href="#uu-diem-cua-knn">&#431;u &#273;i&#7875;m c&#7911;a KNN</a></li>
      <li><a href="#nhuoc-diem-cua-knn">Nh&#432;&#7907;c &#273;i&#7875;m c&#7911;a KNN</a></li>
      <li><a href="#tang-toc-cho-knn">T&#259;ng t&#7889;c cho KNN</a></li>
      <li><a href="#try-this-yourself">Try this yourself</a></li>
      <li><a href="#source-code">Source code</a></li>
    </ul></li>
  <li><a href="#-tai-lieu-tham-khao">5. T&agrave;i li&#7879;u tham kh&#7843;o</a></li>
</ul><!-- /MarkdownTOC --><p><a name="-gioi-thieu" href="knn.html"></a></p>

<h2 id="1-gi&#7899;i-thi&#7879;u">1. Gi&#7899;i thi&#7879;u</h2>

<p><a name="mot-cau-chuyen-vui" href="knn.html"></a></p>

<h3 id="m&#7897;t-c&acirc;u-chuy&#7879;n-vui">M&#7897;t c&acirc;u chuy&#7879;n vui</h3>

<p>C&oacute; m&#7897;t anh b&#7841;n chu&#7849;n b&#7883; &#273;&#7871;n ng&agrave;y thi cu&#7889;i k&#7923;. V&igrave; m&ocirc;n n&agrave;y &#273;&#432;&#7907;c m&#7903; t&agrave;i li&#7879;u khi thi n&ecirc;n anh ta kh&ocirc;ng ch&#7883;u &ocirc;n t&#7853;p &#273;&#7875; hi&#7875;u &yacute; ngh&#297;a c&#7911;a t&#7915;ng b&agrave;i h&#7885;c v&agrave; m&#7889;i li&ecirc;n h&#7879; gi&#7919;a c&aacute;c b&agrave;i. Thay v&agrave;o &#273;&oacute;, anh thu th&#7853;p t&#7845;t c&#7843; c&aacute;c t&agrave;i li&#7879;u tr&ecirc;n l&#7899;p, bao g&#7891;m ghi ch&eacute;p b&agrave;i gi&#7843;ng (lecture notes), c&aacute;c slides v&agrave; b&agrave;i t&#7853;p v&#7873; nh&agrave; + l&#7901;i gi&#7843;i. &#272;&#7875; cho ch&#7855;c, anh ta ra th&#432; vi&#7879;n v&agrave; c&aacute;c qu&aacute;n Photocopy quanh tr&#432;&#7901;ng mua h&#7871;t t&#7845;t c&#7843; c&aacute;c lo&#7841;i t&agrave;i li&#7879;u li&ecirc;n quan (<em>kh&aacute; khen cho c&#7853;u n&agrave;y ch&#7883;u kh&oacute; t&igrave;m ki&#7871;m t&agrave;i li&#7879;u</em>). Cu&#7889;i c&ugrave;ng, anh b&#7841;n c&#7911;a ch&uacute;ng ta thu th&#7853;p &#273;&#432;&#7907;c m&#7897;t ch&#7891;ng cao t&agrave;i li&#7879;u &#273;&#7875; mang v&agrave;o ph&ograve;ng thi. 
<!-- Th&#7853;t kh&ocirc;ng may, c&#7853;u &#7845;y kh&ocirc;ng bi&#7871;t r&#7857;ng trong &#273;&#7889;ng t&agrave;i li&#7879;u mua t&#7915; qu&aacute;n Photocopy &#273;&oacute; c&oacute; nhi&#7873;u b&agrave;i cho &#273;&aacute;p &aacute;n sai.  --></p>

<p>V&agrave;o ng&agrave;y thi, anh t&#7921; tin mang ch&#7891;ng t&agrave;i li&#7879;u v&agrave;o ph&ograve;ng thi. Aha, &#273;&#7873; n&agrave;y &iacute;t nh&#7845;t m&igrave;nh ph&#7843;i &#273;&#432;&#7907;c 8 &#273;i&#7875;m. C&acirc;u 1 gi&#7889;ng h&#7879;t b&agrave;i gi&#7843;ng tr&ecirc;n l&#7899;p. C&acirc;u 2 gi&#7889;ng h&#7879;t &#273;&#7873; thi n&#259;m ngo&aacute;i m&agrave; l&#7901;i gi&#7843;i c&oacute; trong t&#7853;p t&agrave;i li&#7879;u mua &#7903; qu&aacute;n Photocopy. C&acirc;u 3 g&#7847;n gi&#7889;ng v&#7899;i b&agrave;i t&#7853;p v&#7873; nh&agrave;. C&acirc;u 4 tr&#7855;c nghi&#7879;m th&#7853;m ch&iacute; c&#7853;u nh&#7899; ch&iacute;nh x&aacute;c ba t&agrave;i li&#7879;u c&oacute; ghi &#273;&aacute;p &aacute;n. C&acirc;u cu&#7889;i c&ugrave;ng, 1 c&acirc;u kh&oacute; nh&#432;ng anh &#273;&atilde; t&#7915;ng nh&igrave;n th&#7845;y, ch&#7881; l&agrave; kh&ocirc;ng nh&#7899; &#7903; &#273;&acirc;u th&ocirc;i.</p>

<p>K&#7871;t qu&#7843; cu&#7889;i c&ugrave;ng, c&#7853;u ta &#273;&#432;&#7907;c 4 &#273;i&#7875;m, v&#7915;a &#273;&#7911; &#273;i&#7875;m qua m&ocirc;n. C&#7853;u l&agrave;m ch&iacute;nh x&aacute;c c&acirc;u 1 v&igrave; t&igrave;m &#273;&#432;&#7907;c ngay trong t&#7853;p ghi ch&uacute; b&agrave;i gi&#7843;ng. C&acirc;u 2 c&#361;ng t&igrave;m &#273;&#432;&#7907;c &#273;&aacute;p &aacute;n nh&#432;ng l&#7901;i gi&#7843;i c&#7911;a qu&aacute;n Photocopy sai! C&acirc;u ba th&#7845;y g&#7847;n gi&#7889;ng b&agrave;i v&#7873; nh&agrave;, ch&#7881; kh&aacute;c m&#7895;i m&#7897;t s&#7889; th&ocirc;i, c&#7853;u cho k&#7871;t qu&#7843; gi&#7889;ng nh&#432; th&#7871; lu&ocirc;n, v&#7853;y m&agrave; kh&ocirc;ng &#273;&#432;&#7907;c &#273;i&#7875;m n&agrave;o. C&acirc;u 4 th&igrave; t&igrave;m &#273;&#432;&#7907;c c&#7843; 3 t&agrave;i li&#7879;u nh&#432;ng c&oacute; hai trong &#273;&oacute; cho &#273;&aacute;p &aacute;n A, c&aacute;i c&ograve;n l&#7841;i cho B. C&#7853;u ch&#7885;n A v&agrave; &#273;&#432;&#7907;c &#273;i&#7875;m. C&acirc;u 5 th&igrave; kh&ocirc;ng l&agrave;m &#273;&#432;&#7907;c d&ugrave; c&ograve;n t&#7899;i 20 ph&uacute;t, v&igrave; t&igrave;m m&atilde;i ch&#7859;ng th&#7845;y &#273;&aacute;p &aacute;n &#273;&acirc;u - nhi&#7873;u t&agrave;i li&#7879;u qu&aacute; c&#361;ng m&#7879;t!!</p>

<p>Kh&ocirc;ng ph&#7843;i ng&#7851;u nhi&ecirc;n m&agrave; t&ocirc;i d&agrave;nh ra ba &#273;o&#7841;n v&#259;n &#273;&#7875; k&#7875; v&#7873; chuy&#7879;n h&#7885;c h&agrave;nh c&#7911;a anh ch&agrave;ng kia. H&ocirc;m nay t&ocirc;i xin tr&igrave;nh b&agrave;y v&#7873; m&#7897;t ph&#432;&#417;ng ph&aacute;p trong Machine Learning, &#273;&#432;&#7907;c g&#7885;i l&agrave; K-nearest neighbor (hay KNN), m&#7897;t thu&#7853;t to&aacute;n &#273;&#432;&#7907;c x&#7871;p v&agrave;o lo&#7841;i lazy (machine) learning (m&aacute;y l&#432;&#7901;i h&#7885;c). Thu&#7853;t to&aacute;n n&agrave;y kh&aacute; gi&#7889;ng v&#7899;i c&aacute;ch h&#7885;c/thi c&#7911;a anh b&#7841;n k&eacute;m may m&#7855;n kia.</p>

<p><a name="k-nearest-neighbor" href="knn.html"></a></p>

<h3 id="k-nearest-neighbor">K-nearest neighbor</h3>

<p>K-nearest neighbor l&agrave; m&#7897;t trong nh&#7919;ng thu&#7853;t to&aacute;n supervised-learning &#273;&#417;n gi&#7843;n nh&#7845;t (m&agrave; hi&#7879;u qu&#7843; trong m&#7897;t v&agrave;i tr&#432;&#7901;ng h&#7907;p) trong Machine Learning. Khi training, thu&#7853;t to&aacute;n n&agrave;y <em>kh&ocirc;ng h&#7885;c</em> m&#7897;t &#273;i&#7873;u g&igrave; t&#7915; d&#7919; li&#7879;u training (&#273;&acirc;y c&#361;ng l&agrave; l&yacute; do thu&#7853;t to&aacute;n n&agrave;y &#273;&#432;&#7907;c x&#7871;p v&agrave;o lo&#7841;i <a href="https://en.wikipedia.org/wiki/Lazy_learning">lazy learning</a>), m&#7885;i t&iacute;nh to&aacute;n &#273;&#432;&#7907;c th&#7921;c hi&#7879;n khi n&oacute; c&#7847;n d&#7921; &#273;o&aacute;n k&#7871;t qu&#7843; c&#7911;a d&#7919; li&#7879;u m&#7899;i. K-nearest neighbor c&oacute; th&#7875; &aacute;p d&#7909;ng &#273;&#432;&#7907;c v&agrave;o c&#7843; hai lo&#7841;i c&#7911;a b&agrave;i to&aacute;n Supervised learning l&agrave; <a href="/2016/12/27/categories/#classification-phan-loai">Classification</a> v&agrave; <a href="/2016/12/27/categories/#regression-hoi-quy">Regression</a>. KNN c&ograve;n &#273;&#432;&#7907;c g&#7885;i l&agrave; m&#7897;t thu&#7853;t to&aacute;n <a href="https://en.wikipedia.org/wiki/Instance-based_learning">Instance-based hay Memory-based learning</a>.</p>

<p>C&oacute; m&#7897;t v&agrave;i kh&aacute;i ni&#7879;m t&#432;&#417;ng &#7913;ng ng&#432;&#7901;i-m&aacute;y nh&#432; sau:</p>

<table><thead><tr><th>Ng&ocirc;n ng&#7919; ng&#432;&#7901;i</th>
      <th>Ng&ocirc;n ng&#7919; M&aacute;y H&#7885;c</th>
      <th>in Machine Learning</th>
    </tr></thead><tbody><tr><td>C&acirc;u h&#7887;i</td>
      <td>&#272;i&#7875;m d&#7919; li&#7879;u</td>
      <td>Data point</td>
    </tr><tr><td>&#272;&aacute;p &aacute;n</td>
      <td>&#272;&#7847;u ra, nh&atilde;n</td>
      <td>Output, Label</td>
    </tr><tr><td>&Ocirc;n thi</td>
      <td>Hu&#7845;n luy&#7879;n</td>
      <td>Training</td>
    </tr><tr><td>T&#7853;p t&agrave;i li&#7879;u mang v&agrave;o ph&ograve;ng thi</td>
      <td>T&#7853;p d&#7919; li&#7879;u t&#7853;p hu&#7845;n</td>
      <td>Training set</td>
    </tr><tr><td>&#272;&#7873; thi</td>
      <td>T&#7853;p d&#7919; li&#7875;u ki&#7875;m th&#7917;</td>
      <td>Test set</td>
    </tr><tr><td>C&acirc;u h&#7887;i trong d&#7873; thi</td>
      <td>D&#7919; li&#7879;u ki&#7875;m th&#7917;</td>
      <td>Test data point</td>
    </tr><tr><td>C&acirc;u h&#7887;i c&oacute; &#273;&aacute;p &aacute;n sai</td>
      <td>Nhi&#7877;u</td>
      <td>Noise, Outlier</td>
    </tr><tr><td>C&acirc;u h&#7887;i g&#7847;n gi&#7889;ng</td>
      <td>&#272;i&#7875;m d&#7919; li&#7879;u g&#7847;n nh&#7845;t</td>
      <td>Nearest Neighbor</td>
    </tr></tbody></table><p><br>
V&#7899;i KNN, trong b&agrave;i to&aacute;n Classification, label c&#7911;a m&#7897;t &#273;i&#7875;m d&#7919; li&#7879;u m&#7899;i (hay k&#7871;t qu&#7843; c&#7911;a c&acirc;u h&#7887;i trong b&agrave;i thi) &#273;&#432;&#7907;c suy ra tr&#7921;c ti&#7871;p t&#7915; K &#273;i&#7875;m d&#7919; li&#7879;u g&#7847;n nh&#7845;t trong training set. Label c&#7911;a m&#7897;t test data c&oacute; th&#7875; &#273;&#432;&#7907;c quy&#7871;t &#273;&#7883;nh b&#7857;ng major voting (b&#7847;u ch&#7885;n theo s&#7889; phi&#7871;u) gi&#7919;a c&aacute;c &#273;i&#7875;m g&#7847;n nh&#7845;t, ho&#7863;c n&oacute; c&oacute; th&#7875; &#273;&#432;&#7907;c suy ra b&#7857;ng c&aacute;ch &#273;&aacute;nh tr&#7885;ng s&#7889; kh&aacute;c nhau cho m&#7895;i trong c&aacute;c &#273;i&#7875;m g&#7847;n nh&#7845;t &#273;&oacute; r&#7891;i suy ra label. Chi ti&#7871;t s&#7869; &#273;&#432;&#7907;c n&ecirc;u trong ph&#7847;n ti&#7871;p theo.</p>

<p>Trong b&agrave;i to&aacute;n Regresssion, &#273;&#7847;u ra c&#7911;a m&#7897;t &#273;i&#7875;m d&#7919; li&#7879;u s&#7869; b&#7857;ng ch&iacute;nh &#273;&#7847;u ra c&#7911;a &#273;i&#7875;m d&#7919; li&#7879;u &#273;&atilde; bi&#7871;t g&#7847;n nh&#7845;t (trong tr&#432;&#7901;ng h&#7907;p K=1), ho&#7863;c l&agrave; trung b&igrave;nh c&oacute; tr&#7885;ng s&#7889; c&#7911;a &#273;&#7847;u ra c&#7911;a nh&#7919;ng &#273;i&#7875;m g&#7847;n nh&#7845;t, ho&#7863;c b&#7857;ng m&#7897;t m&#7889;i quan h&#7879; d&#7921;a tr&ecirc;n kho&#7843;ng c&aacute;ch t&#7899;i c&aacute;c &#273;i&#7875;m g&#7847;n nh&#7845;t &#273;&oacute;.</p>

<p>M&#7897;t c&aacute;ch ng&#7855;n g&#7885;n, KNN l&agrave; thu&#7853;t to&aacute;n &#273;i t&igrave;m &#273;&#7847;u ra c&#7911;a m&#7897;t &#273;i&#7875;m d&#7919; li&#7879;u m&#7899;i b&#7857;ng c&aacute;ch <em>ch&#7881;</em> d&#7921;a tr&ecirc;n th&ocirc;ng tin c&#7911;a K &#273;i&#7875;m d&#7919; li&#7879;u trong training set g&#7847;n n&oacute; nh&#7845;t (K-l&acirc;n c&#7853;n), <em>kh&ocirc;ng quan t&acirc;m &#273;&#7871;n vi&#7879;c c&oacute; m&#7897;t v&agrave;i &#273;i&#7875;m d&#7919; li&#7879;u trong nh&#7919;ng &#273;i&#7875;m g&#7847;n nh&#7845;t n&agrave;y l&agrave; nhi&#7877;u</em>. H&igrave;nh d&#432;&#7899;i &#273;&acirc;y l&agrave; m&#7897;t v&iacute; d&#7909; v&#7873; KNN trong classification v&#7899;i K = 1.</p>

<div class="imgcap">
<img src="images/52-Map1NN.png" align="center"><div class="thecap"> B&#7843;n &#273;&#7891; c&#7911;a 1NN (Ngu&#7891;n: <a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">Wikipedia</a>) <br></div>
</div>

<p>V&iacute; d&#7909; tr&ecirc;n &#273;&acirc;y l&agrave; b&agrave;i to&aacute;n Classification v&#7899;i 3 classes: &#272;&#7887;, Lam, L&#7909;c. M&#7895;i &#273;i&#7875;m d&#7919; li&#7879;u m&#7899;i (test data point) s&#7869; &#273;&#432;&#7907;c g&aacute;n label theo m&agrave;u c&#7911;a &#273;i&#7875;m m&agrave; n&oacute; thu&#7897;c v&#7873;. Trong h&igrave;nh n&agrave;y, c&oacute; m&#7897;t v&agrave;i v&ugrave;ng nh&#7887; xem l&#7851;n v&agrave;o c&aacute;c v&ugrave;ng l&#7899;n h&#417;n kh&aacute;c m&agrave;u. V&iacute; d&#7909; c&oacute; m&#7897;t &#273;i&#7875;m m&agrave;u L&#7909;c &#7903; g&#7847;n g&oacute;c 11 gi&#7901; n&#7857;m gi&#7919;a hai v&ugrave;ng l&#7899;n v&#7899;i nhi&#7873;u d&#7919; li&#7879;u m&agrave;u &#272;&#7887; v&agrave; Lam. &#272;i&#7875;m n&agrave;y r&#7845;t c&oacute; th&#7875; l&agrave; nhi&#7877;u. D&#7851;n &#273;&#7871;n n&#7871;u d&#7919; li&#7879;u test r&#417;i v&agrave;o v&ugrave;ng n&agrave;y s&#7869; c&oacute; nhi&#7873;u kh&#7843; n&#259;ng cho k&#7871;t qu&#7843; kh&ocirc;ng ch&iacute;nh x&aacute;c.</p>

<p><a name="khoang-cach-trong-khong-gian-vector" href="knn.html"></a></p>

<h3 id="kho&#7843;ng-c&aacute;ch-trong-kh&ocirc;ng-gian-vector">Kho&#7843;ng c&aacute;ch trong kh&ocirc;ng gian vector</h3>

<p>Trong kh&ocirc;ng gian m&#7897;t chi&#7873;u, kho&#7843;ng c&aacute;ch gi&#7919;a hai &#273;i&#7875;m l&agrave; tr&#7883; tuy&#7879;t &#273;&#7889;i gi&#7919;a hi&#7879;u gi&aacute; tr&#7883; c&#7911;a hai &#273;i&#7875;m &#273;&oacute;. Trong kh&ocirc;ng gian nhi&#7873;u chi&#7873;u, kho&#7843;ng c&aacute;ch gi&#7919;a hai &#273;i&#7875;m c&oacute; th&#7875; &#273;&#432;&#7907;c &#273;&#7883;nh ngh&#297;a b&#7857;ng nhi&#7873;u h&agrave;m s&#7889; kh&aacute;c nhau, trong &#273;&oacute; &#273;&#7897; d&agrave;i &#273;&#432;&#7901;ng th&#7857;ng n&#7893;i hai &#273;i&#7875;m ch&#7881; l&agrave; m&#7897;t tr&#432;&#7901;ng h&#7907;p &#273;&#7863;c bi&#7879;t trong &#273;&oacute;. Nhi&#7873;u th&ocirc;ng tin b&#7893; &iacute;ch (cho Machine Learning) c&oacute; th&#7875; &#273;&#432;&#7907;c t&igrave;m th&#7845;y t&#7841;i <a href="/math/#-norms-chuan">Norms (chu&#7849;n) c&#7911;a vector</a> trong tab <a href="math.html">Math</a>.</p>

<p><a name="-phan-tich-toan-hoc" href="knn.html"></a></p>

<h2 id="2-ph&acirc;n-t&iacute;ch-to&aacute;n-h&#7885;c">2. Ph&acirc;n t&iacute;ch to&aacute;n h&#7885;c</h2>
<p>Thu&#7853;t to&aacute;n KNN r&#7845;t d&#7877; hi&#7875;u n&ecirc;n s&#7869; ph&#7847;n &ldquo;Ph&acirc;n t&iacute;ch to&aacute;n h&#7885;c&rdquo; n&agrave;y s&#7869; ch&#7881; c&oacute; 3 c&acirc;u. T&ocirc;i tr&#7921;c ti&#7871;p &#273;i v&agrave;o c&aacute;c v&iacute; d&#7909;. C&oacute; m&#7897;t &#273;i&#7873;u &#273;&aacute;ng l&#432;u &yacute; l&agrave; KNN ph&#7843;i <em>nh&#7899;</em> t&#7845;t c&#7843; c&aacute;c &#273;i&#7875;m d&#7919; li&#7879;u training, vi&#7879;c n&agrave;y kh&ocirc;ng &#273;&#432;&#7907;c l&#7907;i v&#7873; c&#7843; b&#7897; nh&#7899; v&agrave; th&#7901;i gian t&iacute;nh to&aacute;n - gi&#7889;ng nh&#432; khi c&#7853;u b&#7841;n c&#7911;a ch&uacute;ng ta kh&ocirc;ng t&igrave;m &#273;&#432;&#7907;c c&acirc;u tr&#7843; l&#7901;i cho c&acirc;u h&#7887;i cu&#7889;i c&ugrave;ng.</p>

<p><a name="-vi-du-tren-python" href="knn.html"></a></p>

<h2 id="3-v&iacute;-d&#7909;-tr&ecirc;n-python">3. V&iacute; d&#7909; tr&ecirc;n Python</h2>

<p><a name="bo-co-so-du-lieu-iris-iris-flower-dataset" href="knn.html"></a></p>

<h3 id="b&#7897;-c&#417;-s&#7903;-d&#7919;-li&#7879;u-iris-iris-flower-dataset">B&#7897; c&#417; s&#7903; d&#7919; li&#7879;u Iris (Iris flower dataset).</h3>

<p><a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">Iris flower dataset</a> l&agrave; m&#7897;t b&#7897; d&#7919; li&#7879;u nh&#7887; (nh&#7887; h&#417;n r&#7845;t nhi&#7873;u so v&#7899;i <a href="/2017/01/04/kmeans2/#bo-co-so-du-lieu-mnist">MNIST</a>. B&#7897; d&#7919; li&#7879;u n&agrave;y bao g&#7891;m th&ocirc;ng tin c&#7911;a ba lo&#7841;i hoa Iris (m&#7897;t lo&agrave;i hoa lan) kh&aacute;c nhau: Iris setosa, Iris virginica v&agrave; Iris versicolor. M&#7895;i lo&#7841;i c&oacute; 50 b&ocirc;ng hoa &#273;&#432;&#7907;c &#273;o v&#7899;i d&#7919; li&#7879;u l&agrave; 4 th&ocirc;ng tin: chi&#7873;u d&agrave;i, chi&#7873;u r&#7897;ng &#273;&agrave;i hoa (sepal), v&agrave; chi&#7873;u d&agrave;i, chi&#7873;u r&#7897;ng c&aacute;nh hoa (petal). D&#432;&#7899;i &#273;&acirc;y l&agrave; v&iacute; d&#7909; v&#7873; h&igrave;nh &#7843;nh c&#7911;a ba lo&#7841;i hoa. (Ch&uacute; &yacute;, &#273;&acirc;y kh&ocirc;ng ph&#7843;i l&agrave; b&#7897; c&#417; s&#7903; d&#7919; li&#7879;u &#7843;nh nh&#432; MNIST, m&#7895;i &#273;i&#7875;m d&#7919; li&#7879;u trong t&#7853;p n&agrave;y ch&#7881; l&agrave; m&#7897;t vector 4 chi&#7873;u).</p>

<div class="imgcap">
<img src="images/knn-iris.png" align="center" width="800"><div class="thecap"> V&iacute; d&#7909; v&#7873; Iris flower dataset (Ngu&#7891;n: <a href="https://en.wikipedia.org/wiki/Iris_flower_data_set">Wikipedia</a>) <br></div>
</div>

<p>B&#7897; d&#7919; li&#7879;u nh&#7887; n&agrave;y th&#432;&#7901;ng &#273;&#432;&#7907;c s&#7917; d&#7909;ng trong nhi&#7873;u thu&#7853;t to&aacute;n Machine Learning trong c&aacute;c l&#7899;p h&#7885;c. T&ocirc;i s&#7869; gi&#7843;i th&iacute;ch l&yacute; do kh&ocirc;ng ch&#7885;n MNIST v&agrave;o ph&#7847;n sau.</p>

<p><a name="thi-nghiem" href="knn.html"></a></p>

<h3 id="th&iacute;-nghi&#7879;m">Th&iacute; nghi&#7879;m</h3>

<p>Trong ph&#7847;n n&agrave;y, ch&uacute;ng ta s&#7869; t&aacute;ch 150 d&#7919; li&#7879;u trong Iris flower dataset ra th&agrave;nh 2 ph&#7847;n, g&#7885;i l&agrave; <em>training set</em> v&agrave; <em>test set</em>. Thu&#7853;t to&aacute;n KNN s&#7869; d&#7921;a v&agrave;o tr&ocirc;ng tin &#7903; <em>training set</em> &#273;&#7875; d&#7921; &#273;o&aacute;n xem m&#7895;i d&#7919; li&#7879;u trong <em>test set</em> t&#432;&#417;ng &#7913;ng v&#7899;i lo&#7841;i hoa n&agrave;o. D&#7919; li&#7879;u &#273;&#432;&#7907;c d&#7921; &#273;o&aacute;n n&agrave;y s&#7869; &#273;&#432;&#7907;c &#273;&#7889;i chi&#7871;u v&#7899;i lo&#7841;i hoa th&#7853;t c&#7911;a m&#7895;i d&#7919; li&#7879;u trong <em>test set</em> &#273;&#7875; &#273;&aacute;nh gi&aacute; hi&#7879;u qu&#7843; c&#7911;a KNN.</p>

<p><strong>Tr&#432;&#7899;c ti&ecirc;n, ch&uacute;ng ta c&#7847;n khai b&aacute;o v&agrave;i th&#432; vi&#7879;n</strong>.</p>

<p>Iris flower dataset c&oacute; s&#7861;n trong th&#432; vi&#7879;n <a href="http://scikit-learn.org/">scikit-learn</a>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span><span class="p">,</span> <span class="n">datasets</span>
</code></pre></div></div>

<p><strong>Ti&#7871;p theo, ch&uacute;ng ta load d&#7919; li&#7879;u v&agrave; hi&#7879;n th&#7883; v&agrave;i d&#7919; li&#7879;u m&#7851;u</strong>. C&aacute;c class &#273;&#432;&#7907;c g&aacute;n nh&atilde;n l&agrave; 0, 1, v&agrave; 2.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">.</span><span class="n">load_iris</span><span class="p">()</span>
<span class="n">iris_X</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">data</span>
<span class="n">iris_y</span> <span class="o">=</span> <span class="n">iris</span><span class="p">.</span><span class="n">target</span>
<span class="k">print</span> <span class="s">'Number of classes: %d'</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">unique</span><span class="p">(</span><span class="n">iris_y</span><span class="p">))</span>
<span class="k">print</span> <span class="s">'Number of data points: %d'</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">iris_y</span><span class="p">)</span>


<span class="n">X0</span> <span class="o">=</span> <span class="n">iris_X</span><span class="p">[</span><span class="n">iris_y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,:]</span>
<span class="k">print</span> <span class="s">'</span><span class="se">\n</span><span class="s">Samples from class 0:</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">X0</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:]</span>

<span class="n">X1</span> <span class="o">=</span> <span class="n">iris_X</span><span class="p">[</span><span class="n">iris_y</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,:]</span>
<span class="k">print</span> <span class="s">'</span><span class="se">\n</span><span class="s">Samples from class 1:</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">X1</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:]</span>

<span class="n">X2</span> <span class="o">=</span> <span class="n">iris_X</span><span class="p">[</span><span class="n">iris_y</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,:]</span>
<span class="k">print</span> <span class="s">'</span><span class="se">\n</span><span class="s">Samples from class 2:</span><span class="se">\n</span><span class="s">'</span><span class="p">,</span> <span class="n">X2</span><span class="p">[:</span><span class="mi">5</span><span class="p">,:]</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of classes: 3
Number of data points: 150

Samples from class 0:
[[ 5.1  3.5  1.4  0.2]
 [ 4.9  3.   1.4  0.2]
 [ 4.7  3.2  1.3  0.2]
 [ 4.6  3.1  1.5  0.2]
 [ 5.   3.6  1.4  0.2]]

Samples from class 1:
[[ 7.   3.2  4.7  1.4]
 [ 6.4  3.2  4.5  1.5]
 [ 6.9  3.1  4.9  1.5]
 [ 5.5  2.3  4.   1.3]
 [ 6.5  2.8  4.6  1.5]]

Samples from class 2:
[[ 6.3  3.3  6.   2.5]
 [ 5.8  2.7  5.1  1.9]
 [ 7.1  3.   5.9  2.1]
 [ 6.3  2.9  5.6  1.8]
 [ 6.5  3.   5.8  2.2]]
</code></pre></div></div>

<p>N&#7871;u nh&igrave;n v&agrave;o v&agrave;i d&#7919; li&#7879;u m&#7851;u, ch&uacute;ng ta th&#7845;y r&#7857;ng hai c&#7897;t cu&#7889;i mang kh&aacute; nhi&#7873;u th&ocirc;ng tin gi&uacute;p ch&uacute;ng ta c&oacute; th&#7875;  ph&acirc;n bi&#7879;t &#273;&#432;&#7907;c ch&uacute;ng. Ch&uacute;ng ta d&#7921; &#273;o&aacute;n r&#7857;ng k&#7871;t qu&#7843; classification cho c&#417; s&#7903; d&#7919; li&#7879;u n&agrave;y s&#7869; t&#432;&#417;ng &#273;&#7889;i cao.</p>

<p><a name="tach-training-va-test-sets" href="knn.html"></a></p>

<h4 id="t&aacute;ch-training-v&agrave;-test-sets">T&aacute;ch training v&agrave; test sets</h4>
<p>Gi&#7843; s&#7917; ch&uacute;ng ta mu&#7889;n d&ugrave;ng 50 &#273;i&#7875;m d&#7919; li&#7879;u cho test set, 100 &#273;i&#7875;m c&ograve;n l&#7841;i cho training set. Scikit-learn c&oacute; m&#7897;t h&agrave;m s&#7889; cho ph&eacute;p ch&uacute;ng ta ng&#7851;u nhi&ecirc;n l&#7921;a ch&#7885;n c&aacute;c &#273;i&#7875;m n&agrave;y, nh&#432; sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
     <span class="n">iris_X</span><span class="p">,</span> <span class="n">iris_y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Training size: %d"</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="k">print</span> <span class="s">"Test size    : %d"</span> <span class="o">%</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Training size: 100
Test size    : 50
</code></pre></div></div>

<p>Sau &#273;&acirc;y, t&ocirc;i tr&#432;&#7899;c h&#7871;t x&eacute;t tr&#432;&#7901;ng h&#7907;p &#273;&#417;n gi&#7843;n K = 1, t&#7913;c l&agrave; v&#7899;i m&#7895;i &#273;i&#7875;m test data, ta ch&#7881; x&eacute;t 1 &#273;i&#7875;m training data g&#7847;n nh&#7845;t v&agrave; l&#7845;y label c&#7911;a &#273;i&#7875;m &#273;&oacute; &#273;&#7875; d&#7921; &#273;o&aacute;n cho &#273;i&#7875;m test n&agrave;y.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Print results for 20 test data points:"</span>
<span class="k">print</span> <span class="s">"Predicted labels: "</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span>
<span class="k">print</span> <span class="s">"Ground truth    : "</span><span class="p">,</span> <span class="n">y_test</span><span class="p">[</span><span class="mi">20</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Print results for first 20 test data points:
Predicted labels:  [2 1 2 2 1 2 2 0 2 0 2 0 1 0 0 2 2 0 2 0]
Ground truth    :  [2 1 2 2 1 2 2 0 2 0 1 0 1 0 0 2 1 0 2 0]
</code></pre></div></div>

<p><a name="ground-truth" href="knn.html"></a>
K&#7871;t qu&#7843; cho th&#7845;y label d&#7921; &#273;o&aacute;n g&#7847;n gi&#7889;ng v&#7899;i label th&#7853;t c&#7911;a test data, ch&#7881; c&oacute; 2 &#273;i&#7875;m trong s&#7889; 20 &#273;i&#7875;m &#273;&#432;&#7907;c hi&#7875;n th&#7883; c&oacute; k&#7871;t qu&#7843; sai l&#7879;ch. &#7902; &#273;&acirc;y ch&uacute;ng ta l&agrave;m quen v&#7899;i kh&aacute;i ni&#7879;m m&#7899;i: <em>ground truth</em>. M&#7897;t c&aacute;ch &#273;&#417;n gi&#7843;n, <em>ground truth</em> ch&iacute;nh l&agrave; nh&atilde;n/label/&#273;&#7847;u ra <em>th&#7921;c s&#7921;</em> c&#7911;a c&aacute;c &#273;i&#7875;m trong test data. Kh&aacute;i ni&#7879;m n&agrave;y &#273;&#432;&#7907;c d&ugrave;ng nhi&#7873;u trong Machine Learning, hy v&#7885;ng l&#7847;n t&#7899;i c&aacute;c b&#7841;n g&#7863;p th&igrave; s&#7869; nh&#7899; ngay n&oacute; l&agrave; g&igrave;.</p>

<p><a name="phuong-phap-danh-gia-evaluation-method" href="knn.html"></a></p>

<h4 id="ph&#432;&#417;ng-ph&aacute;p-&#273;&aacute;nh-gi&aacute;-evaluation-method">Ph&#432;&#417;ng ph&aacute;p &#273;&aacute;nh gi&aacute; (evaluation method)</h4>
<p>&#272;&#7875; &#273;&aacute;nh gi&aacute; &#273;&#7897; ch&iacute;nh x&aacute;c c&#7911;a thu&#7853;t to&aacute;n KNN classifier n&agrave;y, ch&uacute;ng ta xem xem c&oacute; bao nhi&ecirc;u &#273;i&#7875;m trong test data &#273;&#432;&#7907;c d&#7921; &#273;o&aacute;n &#273;&uacute;ng. L&#7845;y s&#7889; l&#432;&#7907;ng n&agrave;y chia cho t&#7893;ng s&#7889; l&#432;&#7907;ng trong t&#7853;p test data s&#7869; ra &#273;&#7897; ch&iacute;nh x&aacute;c. Scikit-learn cung c&#7845;p h&agrave;m s&#7889; <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html"><code class="language-plaintext highlighter-rouge">accuracy_score</code></a> &#273;&#7875; th&#7921;c hi&#7879;n c&ocirc;ng vi&#7879;c n&agrave;y.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="k">print</span> <span class="s">"Accuracy of 1NN: %.2f %%"</span> <span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy of 1NN: 94.00 %
</code></pre></div></div>

<p>1NN &#273;&atilde; cho ch&uacute;ng ta k&#7871;t qu&#7843; l&agrave; 94%, kh&ocirc;ng t&#7879;! Ch&uacute; &yacute; r&#7857;ng &#273;&acirc;y l&agrave; m&#7897;t c&#417; s&#7903; d&#7919; li&#7879;u d&#7877; v&igrave; ch&#7881; v&#7899;i d&#7919; li&#7879;u &#7903; hai c&#7897;t cu&#7889;i c&ugrave;ng, ch&uacute;ng ta &#273;&atilde; c&oacute; th&#7875; suy ra quy lu&#7853;t. Trong v&iacute; d&#7909; n&agrave;y, t&ocirc;i s&#7917; d&#7909;ng <code class="language-plaintext highlighter-rouge">p = 2</code> ngh&#297;a l&agrave; kho&#7843;ng c&aacute;ch &#7903; &#273;&acirc;y &#273;&#432;&#7907;c t&iacute;nh l&agrave; kho&#7843;ng c&aacute;ch theo <a href="/math/#norm2">norm 2</a>. C&aacute;c b&#7841;n c&#361;ng c&oacute; th&#7875; th&#7917; b&#7857;ng c&aacute;ch thay <code class="language-plaintext highlighter-rouge">p = 1</code> cho <a href="/math/#norm0">norm 1</a>, ho&#7863;c c&aacute;c g&iacute;a tr&#7883; <code class="language-plaintext highlighter-rouge">p</code> kh&aacute;c cho norm kh&aacute;c. (Xem th&ecirc;m <a href="http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.KNeighborsClassifier.html">sklearn.neighbors.KNeighborsClassifier</a>)</p>

<p>Nh&#7853;n th&#7845;y r&#7857;ng ch&#7881; x&eacute;t 1 &#273;i&#7875;m g&#7847;n nh&#7845;t c&oacute; th&#7875; d&#7851;n &#273;&#7871;n k&#7871;t qu&#7843; sai n&#7871;u &#273;i&#7875;m &#273;&oacute; l&agrave; nhi&#7877;u. M&#7897;t c&aacute;ch c&oacute; th&#7875; l&agrave;m t&#259;ng &#273;&#7897; ch&iacute;nh x&aacute;c l&agrave; t&#259;ng s&#7889; l&#432;&#7907;ng &#273;i&#7875;m l&acirc;n c&#7853;n l&ecirc;n, v&iacute; d&#7909; 10 &#273;i&#7875;m, v&agrave; xem xem trong 10 &#273;i&#7875;m g&#7847;n nh&#7845;t, class n&agrave;o chi&#7871;m &#273;a s&#7889; th&igrave; d&#7921; &#273;o&aacute;n k&#7871;t qu&#7843; l&agrave; class &#273;&oacute;. K&#7929; thu&#7853;t d&#7921;a v&agrave;o &#273;a s&#7889; n&agrave;y &#273;&#432;&#7907;c g&#7885;i l&agrave; major voting.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Accuracy of 10NN with major voting: %.2f %%"</span> <span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy of 10NN with major voting: 98.00 %
</code></pre></div></div>

<p>K&#7871;t qu&#7843; &#273;&atilde; t&#259;ng l&ecirc;n 98%, r&#7845;t t&#7889;t!</p>

<p><a name="danh-trong-so-cho-cac-diem-lan-can" href="knn.html"></a></p>

<h4 id="&#273;&aacute;nh-tr&#7885;ng-s&#7889;-cho-c&aacute;c-&#273;i&#7875;m-l&acirc;n-c&#7853;n">&#272;&aacute;nh tr&#7885;ng s&#7889; cho c&aacute;c &#273;i&#7875;m l&acirc;n c&#7853;n</h4>

<p>L&agrave; m&#7897;t k&#7867; tham lam, t&ocirc;i ch&#432;a mu&#7889;n d&#7915;ng k&#7871;t qu&#7843; &#7903; &#273;&acirc;y v&igrave; th&#7845;y r&#7857;ng m&igrave;nh v&#7851;n c&oacute; th&#7875; c&#7843;i thi&#7879;n &#273;&#432;&#7907;c. Trong k&#7929; thu&#7853;t major voting b&ecirc;n tr&ecirc;n, m&#7895;i trong 10 &#273;i&#7875;m g&#7847;n nh&#7845;t &#273;&#432;&#7907;c coi l&agrave; c&oacute; vai tr&ograve; nh&#432; nhau v&agrave; gi&aacute; tr&#7883; <em>l&aacute; phi&#7871;u</em> c&#7911;a m&#7895;i &#273;i&#7875;m n&agrave;y l&agrave; nh&#432; nhau. T&ocirc;i cho r&#7857;ng nh&#432; th&#7871; l&agrave; kh&ocirc;ng c&ocirc;ng b&#7857;ng, v&igrave; r&otilde; r&agrave;ng r&#7857;ng nh&#7919;ng &#273;i&#7875;m g&#7847;n h&#417;n n&ecirc;n c&oacute; tr&#7885;ng s&#7889; cao h&#417;n (<em>c&agrave;ng th&acirc;n c&#7853;n th&igrave; c&agrave;ng tin t&#432;&#7903;ng</em>). V&#7853;y n&ecirc;n t&ocirc;i s&#7869; &#273;&aacute;nh tr&#7885;ng s&#7889; kh&aacute;c nhau cho m&#7895;i trong 10 &#273;i&#7875;m g&#7847;n nh&#7845;t n&agrave;y. C&aacute;ch &#273;&aacute;nh tr&#7885;ng s&#7889; ph&#7843;i tho&#7843;i m&atilde;n &#273;i&#7873;u ki&#7879;n l&agrave; m&#7897;t &#273;i&#7875;m c&agrave;ng g&#7847;n &#273;i&#7875;m test data th&igrave; ph&#7843;i &#273;&#432;&#7907;c &#273;&aacute;nh tr&#7885;ng s&#7889; c&agrave;ng cao (tin t&#432;&#7903;ng h&#417;n). C&aacute;ch &#273;&#417;n gi&#7843;n nh&#7845;t l&agrave; l&#7845;y ngh&#7883;ch &#273;&#7843;o c&#7911;a kho&#7843;ng c&aacute;ch n&agrave;y. (Trong tr&#432;&#7901;ng h&#7907;p test data tr&ugrave;ng v&#7899;i 1 &#273;i&#7875;m d&#7919; li&#7879;u trong training data, t&#7913;c kho&#7843;ng c&aacute;ch b&#7857;ng 0, ta l&#7845;y lu&ocirc;n label c&#7911;a &#273;i&#7875;m training data).</p>

<p>Scikit-learn gi&uacute;p ch&uacute;ng ta &#273;&#417;n gi&#7843;n h&oacute;a vi&#7879;c n&agrave;y b&#7857;ng c&aacute;ch g&aacute;n g&iacute;a tr&#7883; <code class="language-plaintext highlighter-rouge">weights = 'distance'</code>. (Gi&aacute; tr&#7883; m&#7863;c &#273;&#7883;nh c&#7911;a <code class="language-plaintext highlighter-rouge">weights</code> l&agrave; <code class="language-plaintext highlighter-rouge">'uniform'</code>, t&#432;&#417;ng &#7913;ng v&#7899;i vi&#7879;c coi t&#7845;t c&#7843; c&aacute;c &#273;i&#7875;m l&acirc;n c&#7853;n c&oacute; gi&aacute; tr&#7883; nh&#432; nhau nh&#432; &#7903; tr&ecirc;n).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">clf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="s">'distance'</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Accuracy of 10NN (1/distance weights): %.2f %%"</span> <span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy of 10NN (1/distance weights): 100.00 %
</code></pre></div></div>

<p>Aha, 100%.</p>

<p><strong>Ch&uacute; &yacute;:</strong> Ngo&agrave;i 2 ph&#432;&#417;ng ph&aacute;p &#273;&aacute;nh tr&#7885;ng s&#7889; <code class="language-plaintext highlighter-rouge">weights = 'uniform'</code> v&agrave; <code class="language-plaintext highlighter-rouge">weights = 'distance'</code> &#7903; tr&ecirc;n, scikit-learn c&ograve;n cung c&#7845;p cho ch&uacute;ng ta m&#7897;t c&aacute;ch &#273;&#7875; &#273;&aacute;nh tr&#7885;ng s&#7889; m&#7897;t c&aacute;ch t&ugrave;y ch&#7885;n. V&iacute; d&#7909;, m&#7897;t c&aacute;ch &#273;&aacute;nh tr&#7885;ng s&#7889; ph&#7893; bi&#7871;n kh&aacute;c trong Machine Learning l&agrave;:</p>

<p>\[
w_i = \exp \left( \frac{-||\mathbf{x} - \mathbf{x}_i||_2^2}{\sigma^2} \right)
\]
<!-- \\[
w_i = \exp{- \|\|\mathbf{x} - \mathbf{x}_i\|\|_2^2}{\sigma^2}}
\\] --></p>

<p>trong &#273;&oacute; \(\mathbf{x}\) l&agrave; test data, \(\mathbf{x}_i\) l&agrave; m&#7897;t &#273;i&#7875;m trong K-l&acirc;n c&#7853;n c&#7911;a \(\mathbf{x}\), \(w_i\) l&agrave; tr&#7885;ng s&#7889; c&#7911;a &#273;i&#7875;m &#273;&oacute; (&#7913;ng v&#7899;i &#273;i&#7875;m d&#7919; li&#7879;u &#273;ang x&eacute;t \(\mathbf{x}\)), \(\sigma\) l&agrave; m&#7897;t s&#7889; d&#432;&#417;ng. Nh&#7853;n th&#7845;y r&#7857;ng h&agrave;m s&#7889; n&agrave;y c&#361;ng th&#7887;a m&atilde;n &#273;i&#7873;u ki&#7879;n: &#273;i&#7875;m c&agrave;ng g&#7847;n \(\mathbf{x}\) th&igrave; tr&#7885;ng s&#7889; c&agrave;ng cao (cao nh&#7845;t b&#7857;ng 1). V&#7899;i h&agrave;m s&#7889; n&agrave;y, ch&uacute;ng ta c&oacute; th&#7875; l&#7853;p tr&igrave;nh nh&#432; sau:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">myweight</span><span class="p">(</span><span class="n">distances</span><span class="p">):</span>
    <span class="n">sigma2</span> <span class="o">=</span> <span class="p">.</span><span class="mi">5</span> <span class="c1"># we can change this number
</span>    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">distances</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">sigma2</span><span class="p">)</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">weights</span> <span class="o">=</span> <span class="n">myweight</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="k">print</span> <span class="s">"Accuracy of 10NN (customized weights): %.2f %%"</span> <span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Accuracy of 10NN (customized weights): 98.00 %
</code></pre></div></div>

<p>Trong tr&#432;&#7901;ng h&#7907;p n&agrave;y, k&#7871;t qu&#7843; t&#432;&#417;ng &#273;&#432;&#417;ng v&#7899;i k&#7929; thu&#7853;t major voting. &#272;&#7875; &#273;&aacute;nh gi&aacute; ch&iacute;nh x&aacute;c h&#417;n k&#7871;t qu&#7843; c&#7911;a KNN v&#7899;i K kh&aacute;c nhau, c&aacute;ch &#273;&#7883;nh ngh&#297;a kho&#7843;ng c&aacute;ch kh&aacute;c nhau v&agrave; c&aacute;ch &#273;&aacute;nh tr&#7885;ng s&#7889; kh&aacute;c nhau, ch&uacute;ng ta c&#7847;n th&#7921;c hi&#7879;n qu&aacute; tr&igrave;nh tr&ecirc;n v&#7899;i nhi&#7873;u c&aacute;ch chia d&#7919; li&#7879;u <em>training</em> v&agrave; <em>test</em> kh&aacute;c nhau r&#7891;i l&#7845;y k&#7871;t qu&#7843; trung b&igrave;nh, v&igrave; r&#7845;t c&oacute; th&#7875; d&#7919; li&#7879;u ph&acirc;n chia trong 1 tr&#432;&#7901;ng h&#7907;p c&#7909; th&#7875; l&agrave; r&#7845;t t&#7889;t ho&#7863;c r&#7845;t x&#7845;u (bias). &#272;&acirc;y c&#361;ng l&agrave; c&aacute;ch th&#432;&#7901;ng &#273;&#432;&#7907;c d&ugrave;ng khi &#273;&aacute;nh gi&aacute; hi&#7879;u n&#259;ng c&#7911;a m&#7897;t thu&#7853;t to&aacute;n c&#7909; th&#7875; n&agrave;o &#273;&oacute;.</p>

<p><a name="-thao-luan" href="knn.html"></a></p>

<h2 id="4-th&#7843;o-lu&#7853;n">4. Th&#7843;o lu&#7853;n</h2>

<p><a name="knn-cho-regression" href="knn.html"></a></p>

<h3 id="knn-cho-regression">KNN cho Regression</h3>
<p>V&#7899;i b&agrave;i to&aacute;n Regression, ch&uacute;ng ta c&#361;ng ho&agrave;n to&agrave;n c&oacute; th&#7875; s&#7917; d&#7909;ng ph&#432;&#417;ng ph&aacute;p t&#432;&#417;ng t&#7921;: &#432;&#7899;c l&#432;&#7907;ng &#273;&#7847;u ra d&#7921;a tr&ecirc;n &#273;&#7847;u ra v&agrave; kho&#7843;ng c&aacute;ch c&#7911;a c&aacute;c &#273;i&#7875;m trong K-l&acirc;n c&#7853;n. Vi&#7879;c &#432;&#7899;c l&#432;&#7907;ng nh&#432; th&#7871; n&agrave;o c&aacute;c b&#7841;n c&oacute; th&#7875; t&#7921; &#273;&#7883;nh ngh&#297;a t&ugrave;y v&agrave;o t&#7915;ng b&agrave;i to&aacute;n.</p>

<div class="imgcap">
<!-- <img src ="/assets/knn/knnR.png" align = "center"> -->
<img src="images/_images-sphx_glr_plot_regression_001.png" align="center"><div class="thecap"> KNN cho b&agrave;i to&aacute;n Regression  (Ngu&#7891;n: <a href="http://scikit-learn.org/stable/auto_examples/neighbors/plot_regression.html#sphx-glr-auto-examples-neighbors-plot-regression-py">Nearest Neighbors regression</a>) <br></div>
</div>

<p><a name="chuan-hoa-du-lieu" href="knn.html"></a></p>

<h3 id="chu&#7849;n-h&oacute;a-d&#7919;-li&#7879;u">Chu&#7849;n h&oacute;a d&#7919; li&#7879;u</h3>
<p>Khi c&oacute; m&#7897;t thu&#7897;c t&iacute;nh trong d&#7919; li&#7879;u (hay ph&#7847;n t&#7917; trong vector) l&#7899;n h&#417;n c&aacute;c thu&#7897;c t&iacute;nh kh&aacute;c r&#7845;t nhi&#7873;u (v&iacute; d&#7909; thay v&igrave; &#273;o b&#7857;ng cm th&igrave; m&#7897;t k&#7871;t qu&#7843; l&#7841;i t&iacute;nh b&#7857;ng mm), kho&#7843;ng c&aacute;ch gi&#7919;a c&aacute;c &#273;i&#7875;m s&#7869; ph&#7909; thu&#7897;c v&agrave;o thu&#7897;c t&iacute;nh n&agrave;y r&#7845;t nhi&#7873;u. &#272;&#7875; c&oacute; &#273;&#432;&#7907;c k&#7871;t qu&#7843; ch&iacute;nh x&aacute;c h&#417;n, m&#7897;t k&#7929; thu&#7853;t th&#432;&#7901;ng &#273;&#432;&#7907;c d&ugrave;ng l&agrave; <em>Data Normalization</em> (chu&#7849;n h&oacute;a d&#7919; li&#7879;u) &#273;&#7875; &#273;&#432;a c&aacute;c thu&#7897;c t&iacute;nh c&oacute; &#273;&#417;n v&#7883; &#273;o kh&aacute;c nhau v&#7873; c&ugrave;ng m&#7897;t kho&#7843;ng gi&aacute; tr&#7883;, th&#432;&#7901;ng l&agrave; t&#7915; 0 &#273;&#7871;n 1, tr&#432;&#7899;c khi th&#7921;c hi&#7879;n KNN. C&oacute; nhi&#7873;u k&#7929; thu&#7853;t chu&#7849;n h&oacute;a kh&aacute;c nhau, c&aacute;c b&#7841;n s&#7869; &#273;&#432;&#7907;c th&#7845;y khi ti&#7871;p t&#7909;c theo d&otilde;i Blog n&agrave;y. C&aacute;c k&#7929; thu&#7853;t chu&#7849;n h&oacute;a &#273;&#432;&#7907;c &aacute;p d&#7909;ng v&#7899;i kh&ocirc;ng ch&#7881; KNN m&agrave; c&ograve;n v&#7899;i h&#7847;u h&#7871;t c&aacute;c thu&#7853;t to&aacute;n kh&aacute;c.</p>

<p><a name="su-dung-cac-phep-do-khoang-cach-khac-nhau" href="knn.html"></a></p>

<h3 id="s&#7917;-d&#7909;ng-c&aacute;c-ph&eacute;p-&#273;o-kho&#7843;ng-c&aacute;ch-kh&aacute;c-nhau">S&#7917; d&#7909;ng c&aacute;c ph&eacute;p &#273;o kho&#7843;ng c&aacute;ch kh&aacute;c nhau</h3>
<p>Ngo&agrave;i norm 1 v&agrave; norm 2 t&ocirc;i gi&#7899;i thi&#7879;u trong b&agrave;i n&agrave;y, c&ograve;n r&#7845;t nhi&#7873;u c&aacute;c kho&#7843;ng c&aacute;ch kh&aacute;c nhau c&oacute; th&#7875; &#273;&#432;&#7907;c d&ugrave;ng. M&#7897;t v&iacute; d&#7909; &#273;&#417;n gi&#7843;n l&agrave; &#273;&#7871;m s&#7889; l&#432;&#7907;ng thu&#7897;c t&iacute;nh kh&aacute;c nhau gi&#7919;a hai &#273;i&#7875;m d&#7919; li&#7879;u. S&#7889; n&agrave;y c&agrave;ng nh&#7887; th&igrave; hai &#273;i&#7875;m c&agrave;ng g&#7847;n nhau. &#272;&acirc;y ch&iacute;nh l&agrave; <a href="/math/#norm0">gi&#7843; chu&#7849;n 0</a> m&agrave; t&ocirc;i &#273;&atilde; gi&#7899;i thi&#7879;u trong Tab <a href="math.html">Math</a>.</p>

<p><a name="uu-diem-cua-knn" href="knn.html"></a></p>

<h3 id="&#432;u-&#273;i&#7875;m-c&#7911;a-knn">&#431;u &#273;i&#7875;m c&#7911;a KNN</h3>

<ol><li>&#272;&#7897; ph&#7913;c t&#7841;p t&iacute;nh to&aacute;n c&#7911;a qu&aacute; tr&igrave;nh training l&agrave; b&#7857;ng 0.</li>
  <li>Vi&#7879;c d&#7921; &#273;o&aacute;n k&#7871;t qu&#7843; c&#7911;a d&#7919; li&#7879;u m&#7899;i r&#7845;t &#273;&#417;n gi&#7843;n.</li>
  <li>Kh&ocirc;ng c&#7847;n gi&#7843; s&#7917; g&igrave; v&#7873; ph&acirc;n ph&#7889;i c&#7911;a c&aacute;c class.</li>
</ol><p><a name="nhuoc-diem-cua-knn" href="knn.html"></a></p>

<h3 id="nh&#432;&#7907;c-&#273;i&#7875;m-c&#7911;a-knn">Nh&#432;&#7907;c &#273;i&#7875;m c&#7911;a KNN</h3>

<ol><li>KNN r&#7845;t nh&#7841;y c&#7843;m v&#7899;i nhi&#7877;u khi K nh&#7887;.</li>
  <li>Nh&#432; &#273;&atilde; n&oacute;i, KNN l&agrave; m&#7897;t thu&#7853;t to&aacute;n m&agrave; m&#7885;i t&iacute;nh to&aacute;n &#273;&#7873;u n&#7857;m &#7903; kh&acirc;u test. Trong &#273;&oacute; vi&#7879;c t&iacute;nh kho&#7843;ng c&aacute;ch t&#7899;i <em>t&#7915;ng</em> &#273;i&#7875;m d&#7919; li&#7879;u trong training set s&#7869; t&#7889;n r&#7845;t nhi&#7873;u th&#7901;i gian, &#273;&#7863;c bi&#7879;t l&agrave; v&#7899;i c&aacute;c c&#417; s&#7903; d&#7919; li&#7879;u c&oacute; s&#7889; chi&#7873;u l&#7899;n v&agrave; c&oacute; nhi&#7873;u &#273;i&#7875;m d&#7919; li&#7879;u. V&#7899;i K c&agrave;ng l&#7899;n th&igrave; &#273;&#7897; ph&#7913;c t&#7841;p c&#361;ng s&#7869; t&#259;ng l&ecirc;n. Ngo&agrave;i ra, vi&#7879;c l&#432;u to&agrave;n b&#7897; d&#7919; li&#7879;u trong b&#7897; nh&#7899; c&#361;ng &#7843;nh h&#432;&#7903;ng t&#7899;i hi&#7879;u n&#259;ng c&#7911;a KNN.</li>
</ol><p><a name="tang-toc-cho-knn" href="knn.html"></a></p>

<h3 id="t&#259;ng-t&#7889;c-cho-knn">T&#259;ng t&#7889;c cho KNN</h3>
<p>Ngo&agrave;i vi&#7879;c t&iacute;nh to&aacute;n kho&#7843;ng c&aacute;ch t&#7915; m&#7897;t &#273;i&#7875;m test data &#273;&#7871;n t&#7845;t c&#7843; c&aacute;c &#273;i&#7875;m trong traing set (Brute Force), c&oacute; m&#7897;t s&#7889; thu&#7853;t to&aacute;n kh&aacute;c gi&uacute;p t&#259;ng t&#7889;c vi&#7879;c t&igrave;m ki&#7871;m n&agrave;y. B&#7841;n &#273;&#7885;c c&oacute; th&#7867; t&igrave;m ki&#7871;m th&ecirc;m v&#7899;i hai t&#7915; kh&oacute;a: <a href="http://pointclouds.org/documentation/tutorials/kdtree_search.php">K-D Tree</a> v&agrave; <a href="https://en.wikipedia.org/wiki/Ball_tree">Ball Tree</a>. T&ocirc;i xin d&agrave;nh ph&#7847;n n&agrave;y cho &#273;&#7897;c gi&#7843; t&#7921; t&igrave;m hi&#7875;u, v&agrave; s&#7869; quay l&#7841;i n&#7871;u c&oacute; d&#7883;p. Ch&uacute;ng ta v&#7851;n c&ograve;n nh&#7919;ng thu&#7853;t to&aacute;n quan tr&#7885;ng h&#417;n kh&aacute;c c&#7847;n nhi&#7873;u s&#7921; quan t&acirc;m h&#417;n.</p>

<p><a name="try-this-yourself" href="knn.html"></a></p>

<h3 id="try-this-yourself">Try this yourself</h3>

<p>T&ocirc;i c&oacute; vi&#7871;t m&#7897;t &#273;o&#7841;n code ng&#7855;n &#273;&#7875; th&#7921;c hi&#7879;n vi&#7879;c Classification cho c&#417; s&#7903; d&#7919; li&#7879;u <a href="/2017/01/04/kmeans2/#bo-co-so-du-lieu-mnist">MNIST</a>. C&aacute;c b&#7841;n h&atilde;y download to&agrave;n b&#7897; b&#7897; d&#7919; li&#7879;u n&agrave;y v&#7873; v&igrave; sau n&agrave;y ch&uacute;ng ta c&ograve;n d&ugrave;ng nhi&#7873;u, ch&#7841;y th&#7917;, comment k&#7871;t qu&#7843; v&agrave; nh&#7853;n x&eacute;t c&#7911;a c&aacute;c b&#7841;n v&agrave;o ph&#7847;n comment b&ecirc;n d&#432;&#7899;i. &#272;&#7875; tr&#7843; l&#7901;i cho c&acirc;u h&#7887;i v&igrave; sao t&ocirc;i kh&ocirc;ng ch&#7885;n c&#417; s&#7903; d&#7919; li&#7879;u n&agrave;y l&agrave;m v&iacute; d&#7909;, b&#7841;n &#273;&#7885;c c&oacute; th&#7875; t&#7921; t&igrave;m ra &#273;&aacute;p &aacute;n khi ch&#7841;y xong &#273;o&#7841;n code n&agrave;y.</p>

<p>Enjoy!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># %reset
</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
<span class="kn">from</span> <span class="nn">mnist</span> <span class="kn">import</span> <span class="n">MNIST</span> <span class="c1"># require `pip install python-mnist`
# https://pypi.python.org/pypi/python-mnist/
</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">neighbors</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># you need to download the MNIST dataset first
# at: http://yann.lecun.com/exdb/mnist/
</span><span class="n">mndata</span> <span class="o">=</span> <span class="n">MNIST</span><span class="p">(</span><span class="s">'../MNIST/'</span><span class="p">)</span> <span class="c1"># path to your MNIST folder 
</span><span class="n">mndata</span><span class="p">.</span><span class="n">load_testing</span><span class="p">()</span>
<span class="n">mndata</span><span class="p">.</span><span class="n">load_training</span><span class="p">()</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">mndata</span><span class="p">.</span><span class="n">test_images</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">mndata</span><span class="p">.</span><span class="n">train_images</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mndata</span><span class="p">.</span><span class="n">test_labels</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">mndata</span><span class="p">.</span><span class="n">train_labels</span><span class="p">)</span>


<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">.</span><span class="n">KNeighborsClassifier</span><span class="p">(</span><span class="n">n_neighbors</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">clf</span><span class="p">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="p">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
<span class="k">print</span> <span class="s">"Accuracy of 1NN for MNIST: %.2f %%"</span> <span class="o">%</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">))</span>
<span class="k">print</span> <span class="s">"Running time: %.2f (s)"</span> <span class="o">%</span> <span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
</code></pre></div></div>

<p><a name="source-code" href="knn.html"></a></p>

<h3 id="source-code">Source code</h3>
<p>iPython Notebook cho b&agrave;i n&agrave;y c&oacute; th&#7875; <a href="https://github.com/tiepvupsu/tiepvupsu.github.io/tree/master/assets/knn/KNN.ipynb">download t&#7841;i &#273;&acirc;y</a>.</p>

<p><a name="-tai-lieu-tham-khao" href="knn.html"></a></p>

<h2 id="5-t&agrave;i-li&#7879;u-tham-kh&#7843;o">5. T&agrave;i li&#7879;u tham kh&#7843;o</h2>

<ol><li>
    <p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.neighbors.NearestNeighbors.html#sklearn.neighbors.NearestNeighbors">sklearn.neighbors.NearestNeighbors</a></p>
  </li>
  <li>
    <p><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">sklearn.model_selection.train_test_split</a></p>
  </li>
  <li>
    <p><a href="http://machinelearningmastery.com/tutorial-to-implement-k-nearest-neighbors-in-python-from-scratch/">Tutorial To Implement k-Nearest Neighbors in Python From Scratch</a></p>
  </li>
</ol></div>

<hr><em>N&#7871;u c&oacute; c&acirc;u h&#7887;i, B&#7841;n c&oacute; th&#7875; &#273;&#7875; l&#7841;i comment b&ecirc;n d&#432;&#7899;i ho&#7863;c tr&ecirc;n <a href="https://www.facebook.com/groups/257768141347267/">Forum</a> &#273;&#7875; nh&#7853;n &#273;&#432;&#7907;c c&acirc;u tr&#7843; l&#7901;i s&#7899;m h&#417;n.</em>
<br><em>B&#7841;n &#273;&#7885;c c&oacute; th&#7875; &#7911;ng h&#7897; blog qua <a href="buymeacoffee.html">'Buy me a cofee'</a> &#7903; g&oacute;c tr&ecirc;n b&ecirc;n tr&aacute;i c&#7911;a blog.
</em>

<br><em>T&ocirc;i v&#7915;a ho&agrave;n th&agrave;nh cu&#7889;n ebook 'Machine Learning c&#417; b&#7843;n', b&#7841;n c&oacute; th&#7875; &#273;&#7863;t s&aacute;ch <a href="ebook.html">t&#7841;i &#273;&acirc;y</a>.

C&#7843;m &#417;n b&#7841;n.</em>

<hr><!-- previous and next posts --><div class="PageNavigation">
   
      <a class="prev" style="color: #204081;" href="kmeans2.html">&laquo; B&agrave;i 5: K-means Clustering: Simple Applications</a>
   
   
      <a class="next" style="float: right; color: #204081;" href="gradientdescent.html">B&agrave;i 7: Gradient Descent (ph&#7847;n 1/2) &raquo;</a>
   
</div>


<!-- disqus comments -->

      <hr><div id="disqus_thread"></div>
<script type="text/javascript">
  var disqus_shortname  = 'tiepvu';
  var disqus_identifier = 'tiepvupsu.github.io' + '/2017/01/08/knn/';

  (function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    <script id="dsq-count-scr" src="js/count.js" async></script><!-- Start of StatCounter Code for Default Guide --><script type="text/javascript">
var sc_project=11213322; 
var sc_invisible=0; 
var sc_security="1ee84003"; 
var sc_text=2; 
var scJsHost = (("https:" == document.location.protocol) ?
"https://secure." : "http://www.");
document.write("Total visits: <sc"+"ript type='text/javascript' src='" +
scJsHost+
"statcounter.com/counter/counter.js'> </"+"script>");
</script><noscript><div class="statcounter"><a title="web analytics" href="http://statcounter.com/" target="_blank"><img class="statcounter" src="images/1ee84003-0" alt="web
analytics"></a> </div></noscript>
<!-- End of StatCounter Code for Default Guide -->

<!-- <script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->

<script type="text/javascript" async src="js/2.7.1-MathJax.js">
</script><!-- 
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?...">
</script> --></div>
	        <div class="col-md-2 hidden-xs hidden-sm">
	        	
          <!-- Google search -->
<!--           <table border="0">
          <div id = "top-widget" style="width: 252px; margin-left: -13.5px; margin-top: -10px; margin-bottom: -15px;">
         <script>
           (function() {
             var cx = '012053542614118746585:ktgei4l2oek';
             var gcse = document.createElement('script');
             gcse.type = 'text/javascript';
             gcse.async = true;
             gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
             var s = document.getElementsByTagName('script')[0];
             s.parentNode.insertBefore(gcse, s);
           })();
         </script>
         <gcse:search></gcse:search>
          </div>
          </table> -->

          

         <!--  
          <nav>
          
            <div class="header">Latest by category</div>
            <ul>
              
                
              
                
              
                
              
                
                  
                    <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif; color: #204081;" href="/2017/01/08/knn/">B&agrave;i 6: K-nearest neighbors</a></li>
                  
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
                
              
            </ul>
          </nav>
          



          <nav>
            <div class="header">Latest</div>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/lifesofar2/">Con &#273;&#432;&#7901;ng h&#7885;c PhD c&#7911;a t&ocirc;i</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/10/03/conv2d">B&agrave;i 37: T&iacute;ch ch&#7853;p hai chi&#7873;u</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/09/11/forum/">Gi&#7899;i thi&#7879;u Di&#7877;n &#273;&agrave;n Machine Learning c&#417; b&#7843;n</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/07/06/deeplearning/">B&agrave;i 36. Gi&#7899;i thi&#7879;u v&#7873; Keras</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/06/22/deeplearning/">B&agrave;i 35: L&#432;&#7907;c s&#7917; Deep Learning</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/03/22/phuonghoagiang/">B&#7841;n &#273;&#7885;c vi&#7871;t: Con &#273;&#432;&#7901;ng h&#7885;c Khoa h&#7885;c d&#7919; li&#7879;u c&#7911;a m&#7897;t sinh vi&ecirc;n Kinh t&#7871;</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2018/01/14/id3/">B&agrave;i 34: Decision Trees (1): Iterative Dichotomiser 3</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/08/31/evaluation/">B&agrave;i 33: C&aacute;c ph&#432;&#417;ng ph&aacute;p &#273;&aacute;nh gi&aacute; m&#7897;t h&#7879; th&#7889;ng ph&acirc;n l&#7899;p</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/10/20/fundaml_vectors/">FundaML 3: L&agrave;m vi&#7879;c v&#7899;i c&aacute;c m&#7843;ng ng&#7851;u nhi&ecirc;n</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/10/20/fundaml_matrices/">FundaML 2: L&agrave;m vi&#7879;c v&#7899;i ma tr&#7853;n</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/10/12/fundaml_vectors/">FundaML 1: L&agrave;m vi&#7879;c v&#7899;i m&#7843;ng m&#7897;t chi&#7873;u</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/09/24/fundaml/">Gi&#7899;i thi&#7879;u trang web FundaML.com</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/08/08/nbc/">B&agrave;i 32: Naive Bayes Classifier</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/08/05/phdlife/">PhD life 1: Qu&aacute; tr&igrave;nh vi&#7871;t v&agrave; nh&#7853;n x&eacute;t c&aacute;c b&agrave;i b&aacute;o khoa h&#7885;c</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/07/17/mlemap/">B&agrave;i 31: Maximum Likelihood v&agrave; Maximum A Posteriori estimation</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/lifesofar/">Con &#273;&#432;&#7901;ng h&#7885;c To&aacute;n c&#7911;a t&ocirc;i</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/07/09/prob/">B&agrave;i 30: &Ocirc;n t&#7853;p X&aacute;c Su&#7845;t cho Machine Learning</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/07/02/tl/">Quick Note 2: Transfer Learning cho b&agrave;i to&aacute;n ph&acirc;n lo&#7841;i &#7843;nh</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/06/30/lda/">B&agrave;i 29: Linear Discriminant Analysis</a></li>
              
                <li><a style="text-align: left; font-family: 'Open Sans Condensed', sans-serif;color: #204081"  href="/2017/06/22/qns1/">Quick Notes 1</a></li>
              
            </ul>
          </nav> -->

          <aside class="social"><div class="header">Share</div>
          <div class="share-page">
    <!-- <b>Share this on:</b>  <br> -->

    <!-- Facebook -->
    <!-- <a href="https://facebook.com/sharer/sharer.php?u=https://machinelearningcoban.com/2017/01/08/knn/" rel="nofollow" target="_blank" title="Share on Facebook"><img src = "/assets/images/facebook.png" width="25"></a> -->

    <div class="fb-share-button" data-href="https://machinelearningcoban.com/2017/01/08/knn/" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://facebook.com/sharer/sharer.php?u=https://machinelearningcoban.com/2017/01/08/knn/">Share</a></div>


    <!-- Twitter -->
    <!-- <a href="https://twitter.com/intent/tweet?text=B&agrave;i 6: K-nearest neighbors&url=https://machinelearningcoban.com/2017/01/08/knn/&via=&related=" rel="nofollow" target="_blank" title="Share on Twitter" width="25" ><img src = "/assets/images/twitter.png" width="25"></a> -->

    <!-- Google -->
    <!-- <a href="https://plus.google.com/share?url=https://machinelearningcoban.com/2017/01/08/knn/" rel="nofollow" target="_blank" title="Share on Google+"><img src = "/assets/images/google.png" width="25"></a> -->

    
    <!-- LinkedIn -->
    <!-- <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https://machinelearningcoban.com/2017/01/08/knn/" target="_blank"> <img src="/assets/images/linkedin.png" alt="LinkedIn" width="25"/> -->
    <!-- </a> -->

    <!-- Email -->
    <a href="/cdn-cgi/l/email-protection#bb84e8ced9d1ded8cf86e8d2d6cbd7de9be8d3dac9de9bf9cecfcfd4d5c89ddad6cb80f9d4dfc286f29e898bc8dacc9e898bcfd3d2c89e898bdad5df9e898bcfd3d4cedcd3cf9e898bd4dd9e898bc2d4ce9a9e898b9bd3cfcfcbc8819494d6dad8d3d2d5ded7dedac9d5d2d5dcd8d4d9dad595d8d4d694898b8a8c948b8a948b8394d0d5d594">
        <img src="images/images-email.png" alt="Email" width="25"></a>
    <!-- Print -->
    <a href="javascript:;.html" onclick="window.print()">
        <img src="images/images-print.png" alt="Print" width="25"></a>
   </div>
          </aside><nav><div class="header">Di&#7877;n &#273;&agrave;n</div>
            <a href="https://forum.machinelearningcoban.com">
            <img width="100%" src="images/latex-new_logo9-2.png"></a>
          </nav><nav><div class="header">Interactive Learning</div>
            <a href="https://fundaml.com">
            <img width="100%" src="images/images-fundaml_web.png"></a>
          </nav><nav><div class="header" with="100%">Facebook page</div>
          <!-- <a href = "https://www.facebook.com/machinelearningbasicvn/" target="_blank" title="Follow us"><img src = "/assets/images/facebook.png" width="30"></a> -->
          <!-- facebook page -->

         <div class="fb-page" data-href="https://www.facebook.com/machinelearningbasicvn/" data-width="250" data-small-header="false" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="false"><blockquote cite="https://www.facebook.com/machinelearningbasicvn/" class="fb-xfbml-parse-ignore"><a style="color: #204081" href="https://www.facebook.com/machinelearningbasicvn/">Machine Learning c&#417; b&#7843;n</a></blockquote></div>
          <!--end facebook page -->

          </nav><nav><div class="header">Facebook group</div>
            <a href="https://www.facebook.com/groups/257768141347267/">
            <img width="100%" src="images/14_mlp-multi_layers.png"></a>
          </nav><nav><div class="header">Recommended books</div>
            <ul><li> <a style="text-align: left; color: #074B80;" href="https://www.google.com/url?sa=t&amp;rct=j&amp;q=&amp;esrc=s&amp;source=web&amp;cd=1&amp;cad=rja&amp;uact=8&amp;ved=0ahUKEwjd7Y_Q-tzTAhVISyYKHUXyCekQFggvMAA&amp;url=http%3A%2F%2Fusers.isr.ist.utl.pt%2F~wurmd%2FLivros%2Fschool%2FBishop%2520-%2520Pattern%2520Recognition%2520And%2520Machine%2520Learning%2520-%2520Springer%2520%25202006.pdf&amp;usg=AFQjCNEVQzQ_dEpxG4P7NamTWUXnVXzCng&amp;sig2=H1WVtom4rq3uh8UfbGX4oA">"Pattern recognition and Machine Learning.", C. Bishop </a></li>

              <li> <a style="text-align: left; color: #074B80;" href="https://github.com/tpn/pdfs/blob/master/The%20Elements%20of%20Statistical%20Learning%20-%20Data%20Mining%2C%20Inference%20and%20Prediction%20-%202nd%20Edition%20(ESLII_print4).pdf">"The Elements of Statistical Learning", T. Hastie et al.  </a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://www.computervisionmodels.com/">"Computer Vision:  Models, Learning, and Inference", Simon J.D. Prince </a></li>

              <li> <a style="text-align: left; color: #074B80;" href="https://stanford.edu/~boyd/cvxbook/">"Convex Optimization", Boyd and Vandenberghe</a></li>

            </ul></nav><nav><div class="header">Recommended courses</div>

          <ul><li> <a style="text-align: left; color: #074B80;" href="https://www.coursera.org/learn/machine-learning?utm_source=gg&amp;utm_medium=sem&amp;campaignid=693373197&amp;adgroupid=36745103515&amp;device=c&amp;keyword=machine%20learning%20andrew%20ng&amp;matchtype=e&amp;network=g&amp;devicemodel=&amp;adpostion=1t1&amp;creativeid=156061453588&amp;hide_mobile_promo&amp;gclid=Cj0KEQjwt6fHBRDtm9O8xPPHq4gBEiQAdxotvNEC6uHwKB5Ik_W87b9mo-zTkmj9ietB4sI8-WWmc5UaAi6a8P8HAQ">"Machine Learning", Andrew Ng </a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://web.stanford.edu/class/cs224n/">CS224n: Natural Language Processing with Deep Learning</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://cs231n.stanford.edu/">CS231n: Convolutional Neural Networks for Visual Recognition</a></li>           

              <li> <a style="text-align: left; color: #074B80;" href="http://web.stanford.edu/class/cs246/">CS246: Mining Massive Data Sets</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://web.stanford.edu/class/cs20si/syllabus.html">CS20SI: Tensorflow for Deep Learning Research </a></li>

              <li> <a style="text-align: left; color: #074B80;" href="https://www.edx.org/course/introduction-computer-science-mitx-6-00-1x-10">Introduction to Computer Science and Programming Using Python</a></li>           

            </ul></nav><nav><div class="header">Others</div>
          <ul><li> <a style="text-align: left; color: #074B80;" href="https://github.com/ZuzooVn/machine-learning-for-software-engineers">Top-down learning path: Machine Learning for Software Engineers</a></li>
              
              <li> <a style="text-align: left; color: #074B80;" href="howdoIcreatethisblog.html">Blog n&agrave;y &#273;&#432;&#7907;c t&#7841;o nh&#432; th&#7871; n&agrave;o?</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://thepresentwriter.com/chung-toi-da-apply-va-hoc-tien-si-nhu-the-nao-phan-1/">Ch&uacute;ng t&ocirc;i &#273;&atilde; apply v&agrave; h&#7885;c ti&#7871;n s&#7929; nh&#432; th&#7871; n&agrave;o? (1/2)</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://thepresentwriter.com/chung-toi-da-apply-va-hoc-tien-si-nhu-the-nao-phan-2/">Ch&uacute;ng t&ocirc;i &#273;&atilde; apply v&agrave; h&#7885;c ti&#7871;n s&#7929; nh&#432; th&#7871; n&agrave;o? (2/2)</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="http://machinelearningmastery.com/inspirational-applications-deep-learning/">8 Inspirational Applications of Deep Learning</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="https://ccrma.stanford.edu/~dattorro/matrixcalc.pdf">Matrix calculus</a></li>

              <li> <a style="text-align: left; color: #074B80;" href="https://github.com/aymericdamien/TensorFlow-Examples">TensorFlow-Examples</a></li>
              
              <li> <a style="text-align: left; color: #074B80;" href="https://www.forbes.com/sites/quora/2017/04/05/eight-easy-steps-to-get-started-learning-artificial-intelligence/#53c29fa5b117">Eight Easy Steps To Get Started Learning Artificial Intelligence</a></li>
              <li> <a style="text-align: left; color: #074B80;" href="https://adeshpande3.github.io/adeshpande3.github.io/The-9-Deep-Learning-Papers-You-Need-To-Know-About.html">The 9 Deep Learning Papers You Need To Know About</a></li>

                     

            </ul></nav><!-- <img style = "transform: scaleX(1); width:100%; margin-left:00px;position: absolute;" src = "/images/mai.jpg"> --><!--   
            <nav>
              <div class="header">Previous by date</div>
              <ul>
                <li><a style="text-align: left; font-family: 'Roboto Condensed', sans-serif; color: #074B80;" href="/2017/01/04/kmeans2/">B&agrave;i 5: K-means Clustering: Simple Applications</a></li>
              </ul>
            </nav>
           
           
            <nav>
              <div class="header">Next by date</div>
              <ul>
                <li><a style="text-align: left; font-family: 'Roboto Condensed', sans-serif; color: #204081;" href="/2017/01/12/gradientdescent/">B&agrave;i 7: Gradient Descent (ph&#7847;n 1/2)</a></li>
              </ul>
            </nav>
            --><!-- <img style = "transform: scaleX(1); width:250%; margin-left:-100px;" src = "/images/dao.jpg"> --><!-- <a href ="https://www.facebook.com/masspvn/?fref=nf&pnref=story">MaSSP</a> --></div>
      	</div>
    </div>
<script data-cfasync="false" src="js/cloudflare-static-email-decode.min.js"></script></body></html>
